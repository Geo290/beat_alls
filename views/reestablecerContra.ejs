<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Reestablecer Contraseña</title>
    <link rel="shortcut icon" type="image/png" href="/assets/images/LOGO5.png">
    <link rel="stylesheet" href="/assets/css/formulario.css">
</head>
<body>
    <div class="contact_form">
        <div class="formulario">
            <h3 style="color: rgb(131, 163, 251); font-family: Rockwell;">Reestablece tu contraseña</h3>
            <form action="/passChange" method="post" onsubmit="return validarFormulario()">				    
                <p>
                    <label for="email" class="colocar_usuario" style="color: aliceblue;">Usuario</label>
                    <input type="text" placeholder="¿Cuál es tu nombre de usuario?" name="pregunta" id="pregunta" required="obligatorio" style="text-align: center;">
                </p>	
                <p>
                    <label for="password" class="colocar_website" style="color: aliceblue;">Ingresa una nueva contraseña</label>
                    <input type="password" placeholder="Contraseña" name="Contrasena" id="password" placeholder="Crea una contraseña" required="obligatorio" style="text-align: center;">     
                </p>		
                <button type="submit" name="iniciarsesion" id="enviar"><p>Validar</p></button><br><br>
                <button class="btn btn-info"><a style="color: aliceblue; text-decoration: none;" href="/login">Volver</a></button>
            </form>
        </div>
    </div>	

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.7/dist/sweetalert2.all.min.js"></script>
    <script>
        function validarFormulario() {
            // Obtener el valor de la contraseña
            const password = document.getElementById('password').value.trim();
    
            // Validar longitud y caracteres especiales
            if (password.length !== 8 || /[^\w\d]/.test(password)) {
                Swal.fire({
                    icon: 'error',
                    title: 'Error de validación',
                    text: 'La contraseña debe tener una longitud de 8 caracteres y solo puede contener letras y números.'
                });
            } else {
                Swal.fire({
                    title: "Contraseña restablecida",
                    text: "La contraseña se ha restablecido exitosamente.",
                    icon: "success",
                    showConfirmButton: false,
                    timer: 3000
                }).then(() => {
                    window.location.href = '/login';
                });
            }
        }
    </script>
    
</body>
</html>
